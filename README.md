# Cavrtbany-X1 智能猫砂盆对接文档

## 项目概述

本项目包含 Cavrtbany-X1 智能猫砂盆与涂鸦IoT平台对接的详细文档和相关配置文件。

## 文档结构

```
Cavrtbany-X1-对接/
├── README.md                           # 项目说明文档（本文件）
├── 日志区域判断逻辑.md                 # 设备日志判断逻辑详细说明
└── 智能猫砂盆DP点20251104.xlsx         # 涂鸦平台DP点配置表
```

## 核心功能说明

### 设备状态检测
- **猫咪进入检测**：检测到重量大于800g且持续至少8秒
- **猫咪离开检测**：在猫咪进入状态下，重量小于800g时触发
- **体重记录**：通过DP6记录猫咪体重数据（单位：g）
- **如厕时长**：通过DP8记录猫咪如厕时长

### 设备控制功能
- **自动/手动模式切换**
- **清理功能**（开始、暂停、结束）
- **清空功能**（开始、暂停、结束）
- **猫砂抚平**（开始、暂停、结束）
- **童锁控制**（开启/关闭）
- **指示灯控制**（开启/关闭）
- **勿扰模式**（时间段设置）

### 故障检测系统
设备支持多种故障检测，通过DP22的bit位进行标识：
- bit0: 垃圾盒满
- bit1: 电机故障
- bit2: 电机堵转
- bit3: 顶盖不在位
- bit4: 称重故障
- bit5: 电压异常
- bit7: 故障清理完成

## 日志事件类型

设备支持记录以下29种日志事件：

1. 设备模式切换（自动/手动）
2. 猫咪行为记录（进入/离开/体重/时长）
3. 功能设置变更（童锁/勿扰模式/清理等待时长）
4. 故障状态变化（故障发生/解除）
5. 设备恢复操作（恢复出厂设置）
6. 设备操作记录（清理/清空/抚平猫砂）

## 技术参数

- **重量检测阈值**：800g
- **进入判定时间**：8秒
- **重量单位**：克（g），涂鸦后台设置倍率为1
- **故障管理**：使用位图方式管理多种故障状态

## 文档说明

### `日志区域判断逻辑.md`
详细说明了设备各种状态的判断逻辑、日志记录规则以及故障处理机制。包含Q&A形式的常见问题解答。

### `智能猫砂盆DP点20251104.xlsx`
涂鸦平台DP（Data Point）配置表，包含所有设备功能的定义、数据类型、传输属性等详细信息。

## 注意事项

1. **单位转换**：硬件传输的重量单位为克，在涂鸦后台配置时需注意倍率设置
2. **故障处理**：不同故障类型使用不同的DP点进行管理，避免时间戳冲突
3. **状态管理**：猫咪进入/离开状态需要准确的状态机来管理
4. **日志记录**：所有事件都应包含准确的时间戳信息

## 更新日志

- **2025-11-04**: 初始化项目文档，完善日志判断逻辑和DP点配置

---

*本文档最后更新时间：2025-11-04*